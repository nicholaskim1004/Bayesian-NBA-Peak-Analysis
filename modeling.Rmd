---
title: "final_proj"
author: "Nick Kim"
date: "2025-11-27"
output: pdf_document
---

```{r}
nba <- read.csv("/Users/nicholaskim/Documents/STAT 551/final proj/Data/Win_Shares_College_Draft.csv")

#removing first column as it stores the index of the data
nba <- nba[,-1]

#converting Draft.Picks into a numeric
nba$Draft.Pick <- as.numeric(nba$Draft.Pick)

#Since "Undrafted" will become NA will set this to be -5 to distinguish
nba$Draft.Pick[is.na(nba$Draft.Pick)] <- -5

#creating a factor on the type of draft pick they were 1st, 2nd, Undrafted
rounds = numeric(nrow(nba))
for (i in 1:nrow(nba)){
  if ((nba[i,11] <= 32) & (nba[i,11] > 0)){
    rounds[i] = "1st"
  }
  else if (nba[i,11]<= 0){
    rounds[i] = "Undrafted"
  }
  else{
    rounds[i] = "2nd"
  }
}

nba$Round <- as.factor(rounds)

#filling in missing info for 2 players
nba[nba$Player=="Sekou Doumbouya",10] <- "INSEP"
nba[nba$Player=="MÃ£ozinha Pereira",10] <- "Cearense"

#changing Undrafted player to be -5 for consistency
nba[nba$Player=="Scotty Hopson",11] <- -5
```

Lets see the different distributions of draft picks by college

```{r}
table(nba$College, nba$Round)
```

```{r}
library(dbplyr)

round_df <- as.data.frame(table(nba$College, nba$Round))
colnames(round_df) <- c("College","Round","Count")

round_df <- round_df %>% arrange(desc(Count))
round_df %>% filter(Round == "1st") %>% slice_head(n=10)
```

This is showing the percentage that a player from that college will be a 1st, 2nd, or go Undrafted

```{r}
pick_prop <- round_df %>% group_by(College) %>% 
  summarise(total = sum(Count),
            prop_1st = sum(Count[Round == "1st"])/total,
            prop_2nd = sum(Count[Round == "2nd"])/total,
            prop_und = sum(Count[Round == "Undrafted"])/total)
pick_prop
```

Now lets look at how productive a player is from some draft position
```{r}
nba %>% group_by(Round) %>% 
  summarise(mean_WS = mean(WS),
            mean_BPM = mean(BPM),
            mean_PER = mean(PER))
```

Now with granular look by college
```{r}
WS_by_player_college <- nba %>%
  group_by(Player, College, Round) %>%
  summarise(
    mean_WS  = mean(WS, na.rm = TRUE),
    mean_BPM = mean(BPM, na.rm = TRUE),
    mean_PER = mean(PER, na.rm = TRUE),
    .groups = "drop"
  )

```

```{r}
college_summary <- WS_by_player_college %>%
  group_by(College) %>%
  summarise(
    player_count = n(),                                 
    num_1st = sum(Round == "1st"),
    num_2nd = sum(Round == "2nd"),
    num_und = sum(Round == "Undrafted"),
    
    avg_WS = mean(mean_WS),
    avg_BPM = mean(mean_BPM),
    avg_PER = mean(mean_PER),
    .groups = "drop"
  )

```

Let's also look at the percentage of star players to get more granularity!

Creating levels by the number of standard deviations away a players WS is by year

```{r}
nba %>%
  group_by(Year) %>%
  mutate(
    WS_pct = percent_rank(WS),
    tier = case_when(
      WS_pct >= 0.90 ~ "Superstar",
      WS_pct >= 0.75 ~ "Star",
      WS_pct >= 0.40 ~ "Role Player",
      WS_pct >= 0.10 ~ "Bench",
      TRUE ~ "Non-Rotation"
    )
  )

```



```{r}
library(ggplot2)

ggplot(data = nba, aes(x = Draft.Pick, fill = Round)) +
  geom_histogram(bins = 60)
```

```{r}
ken = nba[nba$College == "Kentucky", ]
ken$Draft.Pick = as.numeric(ken$Draft.Pick)
ggplot(data = ken, aes(x = Draft.Pick, fill = Round)) +
  geom_histogram()
```








